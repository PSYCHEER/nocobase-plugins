/**
 * This file is part of the NocoBase (R) project.
 * Copyright (c) 2020-2024 NocoBase Co., Ltd.
 * Authors: NocoBase Team.
 *
 * This project is dual-licensed under AGPL-3.0 and NocoBase Commercial License.
 * For more information, please refer to: https://www.nocobase.com/agreement.
 */

!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("react"),require("@nocobase/client"),require("antd")):"function"==typeof define&&define.amd?define("@psycheer/plugin-annoyancy-removal",["react","@nocobase/client","antd"],n):"object"==typeof exports?exports["@psycheer/plugin-annoyancy-removal"]=n(require("react"),require("@nocobase/client"),require("antd")):e["@psycheer/plugin-annoyancy-removal"]=n(e.react,e["@nocobase/client"],e.antd)}(self,function(e,n,t){return function(){"use strict";var r={772:function(e){e.exports=n},721:function(e){e.exports=t},156:function(n){n.exports=e}},i={};function a(e){var n=i[e];if(void 0!==n)return n.exports;var t=i[e]={exports:{}};return r[e](t,t.exports,a),t.exports}a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,{a:n}),n},a.d=function(e,n){for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return!function(){a.r(o),a.d(o,{PluginAnnoyancyRemovalClient:function(){return w},default:function(){return E}});var e=a(772),n=a(156),t=a.n(n),r=a(721);function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function l(e,n,t,r,i,a,o){try{var l=e[a](o),c=l.value}catch(e){t(e);return}l.done?n(c):Promise.resolve(c).then(r,i)}function c(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t,r,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a=[],o=!0,l=!1;try{for(i=i.call(e);!(o=(t=i.next()).done)&&(a.push(t.value),!n||a.length!==n);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(l)throw r}}return a}}(e,n)||function(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,n)}}(e,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var u=r.Typography.Title,s=r.Typography.Text,d=function(){var i,a,o=(0,e.useAPIClient)(),d=c(r.Form.useForm(),1)[0],m=c((0,n.useState)(!1),2),p=m[0],f=m[1],y=(0,e.useRequest)(function(){return o.request({url:"annoyancyRemovalSettings:get",method:"post"})}),h=y.data,v=y.loading;y.refresh,(0,n.useEffect)(function(){var e=null==h||null==(n=h.data)?void 0:n.data;if(e&&(void 0===e?"undefined":e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)=="object"){var n,t,r,i,a,o,l,c={hideLicenseSettings:null==(t=e.hideLicenseSettings)||t,hideAiIntegration:null==(r=e.hideAiIntegration)||r,hideMobileDeprecated:null==(i=e.hideMobileDeprecated)||i,hideChangePassword:null==(a=e.hideChangePassword)||a,hideVerification:null==(o=e.hideVerification)||o,hideTheme:null==(l=e.hideTheme)||l};d.setFieldsValue(c)}},[h,d]);var g=(i=function(e,n){return function(e,n){var t,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){var c=[a,l];if(t)throw TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=n.call(e,o)}catch(e){c=[6,e],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:f(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,o.request({url:"annoyancyRemovalSettings:update?filterByTk=1",method:"post",data:n})];case 2:return e.sent(),r.message.success("Settings saved successfully"),setTimeout(function(){window.location.reload()},1e3),[3,5];case 3:return e.sent(),r.message.error("Failed to save settings"),[3,5];case 4:return f(!1),[7];case 5:return[2]}})},a=function(){var e=this,n=arguments;return new Promise(function(t,r){var a=i.apply(e,n);function o(e){l(a,t,r,o,c,"next",e)}function c(e){l(a,t,r,o,c,"throw",e)}o(void 0)})},function(e,n){return a.apply(this,arguments)});return t().createElement(r.Card,{title:t().createElement(u,{level:3},"Annoyancy Removal Settings"),loading:v},t().createElement(r.Form,{form:d,layout:"vertical",onValuesChange:g,initialValues:{hideLicenseSettings:!0,hideAiIntegration:!0,hideMobileDeprecated:!0,hideChangePassword:!0,hideVerification:!0,hideTheme:!0}},t().createElement(r.Space,{direction:"vertical",size:"large",style:{width:"100%"}},t().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t().createElement("div",null,t().createElement(s,{strong:!0},'Hide "License settings"'),t().createElement("br",null),t().createElement(s,{type:"secondary"},"Remove license settings menu items and buttons")),t().createElement(r.Form.Item,{name:"hideLicenseSettings",valuePropName:"checked",noStyle:!0},t().createElement(r.Switch,{loading:p}))),t().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t().createElement("div",null,t().createElement(s,{strong:!0},'Hide "AI integration"'),t().createElement("br",null),t().createElement(s,{type:"secondary"},"Remove AI integration menu items and buttons")),t().createElement(r.Form.Item,{name:"hideAiIntegration",valuePropName:"checked",noStyle:!0},t().createElement(r.Switch,{loading:p}))),t().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t().createElement("div",null,t().createElement(s,{strong:!0},'Hide "Mobile (deprecated)"'),t().createElement("br",null),t().createElement(s,{type:"secondary"},"Remove deprecated mobile menu items and buttons")),t().createElement(r.Form.Item,{name:"hideMobileDeprecated",valuePropName:"checked",noStyle:!0},t().createElement(r.Switch,{loading:p}))),t().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t().createElement("div",null,t().createElement(s,{strong:!0},'Hide "Change password"'),t().createElement("br",null),t().createElement(s,{type:"secondary"},'Remove "Change password" from user dropdown menu')),t().createElement(r.Form.Item,{name:"hideChangePassword",valuePropName:"checked",noStyle:!0},t().createElement(r.Switch,{loading:p}))),t().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t().createElement("div",null,t().createElement(s,{strong:!0},'Hide "Verification"'),t().createElement("br",null),t().createElement(s,{type:"secondary"},'Remove "Verification" from user dropdown menu')),t().createElement(r.Form.Item,{name:"hideVerification",valuePropName:"checked",noStyle:!0},t().createElement(r.Switch,{loading:p}))),t().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t().createElement("div",null,t().createElement(s,{strong:!0},'Hide "Theme"'),t().createElement("br",null),t().createElement(s,{type:"secondary"},'Remove "Theme" from user dropdown menu')),t().createElement(r.Form.Item,{name:"hideTheme",valuePropName:"checked",noStyle:!0},t().createElement(r.Switch,{loading:p}))))))};function m(e,n,t,r,i,a,o){try{var l=e[a](o),c=l.value}catch(e){t(e);return}l.done?n(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var n=this,t=arguments;return new Promise(function(r,i){var a=e.apply(n,t);function o(e){m(a,r,i,o,l,"next",e)}function l(e){m(a,r,i,o,l,"throw",e)}o(void 0)})}}function f(e,n,t){return(f=g()?Reflect.construct:function(e,n,t){var r=[null];r.push.apply(r,n);var i=new(Function.bind.apply(e,r));return t&&h(i,t.prototype),i}).apply(null,arguments)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,n){return(h=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function v(e){var n="function"==typeof Map?new Map:void 0;return(v=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return f(e,arguments,y(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),h(t,e)})(e)}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function b(e,n){var t,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){var c=[a,l];if(t)throw TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=n.call(e,o)}catch(e){c=[6,e],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var w=function(e){var n;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function t(){var e,n;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");return e=t,n=arguments,e=y(e),function(e,n){var t;if(n&&("object"==((t=n)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)||"function"==typeof n))return n;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,g()?Reflect.construct(e,n||[],y(this).constructor):e.apply(this,n))}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e),n=[{key:"afterAdd",value:function(){return p(function(){return b(this,function(e){return[2]})})()}},{key:"beforeLoad",value:function(){return p(function(){return b(this,function(e){return[2]})})()}},{key:"load",value:function(){var e=this;return p(function(){var n,t,r;return b(this,function(i){var a;return e.app.pluginSettingsManager.add("annoyancy-removal-settings",{title:"Annoyancy Removal",icon:"EyeInvisibleOutlined",Component:d,aclSnippet:"pm.annoyancy-removal-settings"}),a=p(function(){var n,t;return b(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.app.apiClient.request({url:"annoyancyRemovalSettings:get",method:"post"})];case 1:return[2,(null==(t=r.sent())||null==(n=t.data)?void 0:n.data)||{hideLicenseSettings:!0,hideAiIntegration:!0,hideMobileDeprecated:!0,hideChangePassword:!0,hideVerification:!0,hideTheme:!0}];case 2:return r.sent(),[2,{hideLicenseSettings:!0,hideAiIntegration:!0,hideMobileDeprecated:!0,hideChangePassword:!0,hideVerification:!0,hideTheme:!0}];case 3:return[2]}})}),(n=function(){var n=window.location.pathname||"";/signin|login|register|auth|callback|oidc|oauth/i.test(n)||"/"===n||n.startsWith("/admin")&&window.location.search.includes("authenticator")||(function(){return a.apply(this,arguments)})().then(function(n){(n.hideLicenseSettings||n.hideAiIntegration||n.hideMobileDeprecated)&&e.hideElements(n),e.blockLicenseUrls()}).catch(function(){})})(),window.addEventListener("load",n),window.addEventListener("pageshow",n),t=history.pushState,r=history.replaceState,history.pushState=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];t.apply(history,r),n()},history.replaceState=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];r.apply(history,t),n()},window.addEventListener("popstate",n),[2]})})()}},{key:"blockLicenseUrls",value:function(){var e=function(){var e=window.location.pathname;!e.includes("annoyancy-removal")&&(e.includes("/admin/settings/license-settings")||e.includes("/admin/settings/license"))&&(window.location.href="/admin/settings")};e();var n=history.pushState,t=history.replaceState;history.pushState=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];n.apply(history,r),e()},history.replaceState=function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(history,r),e()},window.addEventListener("popstate",e)}},{key:"hideElements",value:function(e){var n=function(){var n=document.getElementById("license-hider-styles");if(n&&n.remove(),!window.location.pathname.includes("annoyancy-removal")){var t=document.createElement("style");t.id="license-hider-styles";var r="";e.hideLicenseSettings&&(r+='\n        a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"]),\n        li[data-menu-id*="license"]:not([data-menu-id*="annoyancy-removal"]):not([data-menu-id*="permissions"]) {\n          display: none !important;\n        }\n        \n        .ant-menu-item:has(a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"])) {\n          display: none !important;\n        }\n        \n        li:has(a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"])) {\n          display: none !important;\n        }\n        \n        .ant-card:has(a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"])),\n        .ant-list-item:has(a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"])),\n        .ant-col:has(a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"])) {\n          display: none !important;\n        }\n        '),e.hideAiIntegration&&(r+='\n        li.ant-menu-item[data-menu-id="ai"],\n        li.ant-menu-item[data-menu-id^="ai-"],\n        li.ant-menu-item[data-menu-id$="-ai"],\n        li.ant-menu-item[data-menu-id*="-ai-"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id="ai"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id^="ai-"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id$="-ai"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id*="-ai-"] {\n          display: none !important;\n        }\n        \n        .ant-card:has(a[href^="/admin/settings/ai"]),\n        .ant-list-item:has(a[href^="/admin/settings/ai"]),\n        .ant-col:has(a[href^="/admin/settings/ai"]) {\n          display: none !important;\n        }\n        '),e.hideMobileDeprecated&&(r+='\n        li.ant-menu-item[data-menu-id$="-mobile"],\n        li.ant-menu-item[title="Mobile (deprecated)"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id="mobile"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id^="mobile-"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id$="-mobile"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id*="-mobile-"] {\n          display: none !important;\n        }\n        '),e.hideChangePassword&&(r+='\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id*="changePassword"],\n        .ant-dropdown li.ant-dropdown-menu-item[title="changePassword"] {\n          display: none !important;\n        }\n        '),e.hideVerification&&(r+='\n        li.ant-menu-item[data-menu-id$="-verification"],\n        li.ant-menu-item[title="Verification"],\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id*="verification"],\n        .ant-dropdown li.ant-dropdown-menu-item[title="verification"] {\n          display: none !important;\n        }\n        '),e.hideTheme&&(r+='\n        .ant-dropdown li.ant-dropdown-menu-item[data-menu-id*="theme"],\n        .ant-dropdown li.ant-dropdown-menu-item[title="theme"] {\n          display: none !important;\n        }\n        '),t.textContent=r,document.head.appendChild(t)}};n(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",n),new MutationObserver(function(){var n=window.location.pathname;n.includes("annoyancy-removal")||n.includes("permissions")||setTimeout(function(){e.hideLicenseSettings&&document.querySelectorAll('a[href*="/admin/settings/license"]:not([href*="annoyancy-removal"]):not([href*="permissions"])').forEach(function(e){var n=e.closest("li")||e.closest(".ant-menu-item")||e.parentElement;n&&(n.style.display="none")}),e.hideAiIntegration&&(document.querySelectorAll('li.ant-menu-item[data-menu-id="ai"], li.ant-menu-item[data-menu-id^="ai-"], li.ant-menu-item[data-menu-id$="-ai"], li.ant-menu-item[data-menu-id*="-ai-"]').forEach(function(e){return e.style.display="none"}),document.querySelectorAll(".ant-card").forEach(function(e){var n=e.textContent||"";(n.includes("AI integration")||n.includes("AI Integration"))&&(e.style.display="none")})),e.hideMobileDeprecated&&(document.querySelectorAll("li.ant-menu-item").forEach(function(e){var n,t=e.querySelector(".ant-menu-title-content");t&&(null==(n=t.textContent)?void 0:n.includes("Mobile (deprecated)"))&&(e.style.display="none")}),document.querySelectorAll(".ant-card").forEach(function(e){(e.textContent||"").includes("Mobile (deprecated)")&&(e.style.display="none")})),e.hideChangePassword&&document.querySelectorAll(".ant-dropdown li.ant-dropdown-menu-item").forEach(function(e){(e.textContent||"").includes("Change password")&&(e.style.display="none")}),e.hideVerification&&document.querySelectorAll(".ant-dropdown li.ant-dropdown-menu-item").forEach(function(e){(e.textContent||"").includes("Verification")&&(e.style.display="none")}),e.hideTheme&&document.querySelectorAll(".ant-dropdown li.ant-dropdown-menu-item").forEach(function(e){(e.textContent||"").includes("Theme")&&(e.style.display="none")})},100)}).observe(document.body,{childList:!0,subtree:!0})}}],function(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,n),t}(v(e.Plugin)),E=w}(),o}()});